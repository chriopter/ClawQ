<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ClawQ</title>
    <link rel="icon" type="image/svg+xml" href="/static/clawq-logo.svg" />
    <link rel="stylesheet" href="/static/style.css" />
    <script defer src="/static/dashboard.js"></script>
  </head>
  <body>
    <header class="topbar">
      <div class="brand">
        <img class="logo" src="/static/clawq-logo.svg" alt="ClawQ logo" />
        <strong>ClawQ</strong>
      </div>
      <form method="post" action="/logout">
        <button type="submit" class="btn-secondary">Logout</button>
      </form>
    </header>

    <div class="app-shell">
      <aside class="sidebar">
        <nav class="sidebar-nav" aria-label="Primary sections">
          <button type="button" class="nav-btn active" data-view="repos" data-hotkey="1">
            <span class="nav-headline"><span class="nav-key">1</span><span>Repos</span></span>
            <span class="nav-meta-row">
              <span id="navReposState" class="nav-state neutral">checking</span>
              <span id="navReposDetail" class="nav-detail">sync...</span>
            </span>
          </button>
          <button type="button" class="nav-btn" data-view="memory" data-hotkey="2">
            <span class="nav-headline"><span class="nav-key">2</span><span>Memory</span></span>
            <span class="nav-meta-row">
              <span id="navMemoryState" class="nav-state neutral">checking</span>
              <span id="navMemoryDetail" class="nav-detail">sync...</span>
            </span>
          </button>
          <button type="button" class="nav-btn" data-view="status" data-hotkey="3">
            <span class="nav-headline"><span class="nav-key">3</span><span>Status</span></span>
            <span class="nav-meta-row">
              <span id="navStatusState" class="nav-state neutral">checking</span>
              <span id="navStatusDetail" class="nav-detail">runtime...</span>
            </span>
          </button>
        </nav>
        <p class="sidebar-hint">Press 1-3 to switch sections.</p>
      </aside>

      <main class="layout">
        <section id="view-repos" class="view active">
          <section class="card">
            <div class="card-head">
              <span class="card-title">Repo Hooker</span>
              <span id="repoHookerDefaultTarget" class="hook-target-note">Default: {{ notify_default_label }}</span>
              <button id="repoHookerDefaultTestBtn" type="button" class="btn-secondary btn-mini">Test</button>
              <span id="repoHookerSummaryMini" class="meta">Loading...</span>
            </div>
            <div class="card-body">
              <div id="repoHookerContent" class="content-empty">Loading...</div>
            </div>
          </section>

          <section class="card">
            <div class="card-head">
              <h2>Repos</h2>
              <span id="reposSummaryMini" class="meta">Loading...</span>
            </div>
            <div class="card-body">
              <div id="reposContent" class="content-empty">Loading...</div>
            </div>
          </section>
        </section>

        <section id="view-memory" class="view">
          <section class="card">
            <div class="card-head">
              <span class="card-title">Memory Hooker</span>
              <select id="memoryHookerTargetSelect" class="hook-target-select" aria-label="Memory Hooker Signal target" {% if not notify_options %}disabled{% endif %}>
                {% if notify_options %}
                  {% for option in notify_options %}
                    <option value="{{ option.value }}" {% if option.value == notify_memory_target %}selected{% endif %}>{{ option.label }}</option>
                  {% endfor %}
                {% else %}
                  <option value="">No target</option>
                {% endif %}
              </select>
              <button id="memoryHookerTestBtn" type="button" class="btn-secondary btn-mini">Test</button>
              <span id="memoryHookerSummaryMini" class="meta">Loading...</span>
            </div>
            <div class="card-body">
              <div id="memoryHookerContent" class="content-empty">Loading...</div>
            </div>
          </section>

          <section class="card">
            <div class="card-head">
              <span class="card-title">Memory</span>
              <span id="memoryStatusBadge" class="status-pill neutral">checking</span>
              <span id="memorySummaryMini" class="meta">README.md</span>
            </div>
            <div class="card-body">
              <div class="memory-link-row">
                <span class="sync-meta">Memory source: <code>/root/workspaces/README.md</code></span>
              </div>
              <div id="syncStatus" class="sync-strip">Checking repository sync...</div>
              <div class="document-shell" role="region" aria-label="Workspace document preview">
                <div class="document-head">
                  <span class="doc-badge">Document</span>
                  <span class="doc-title">{{ readme_title }}</span>
                </div>
                <article class="readme-prose">{{ readme_html | safe }}</article>
              </div>
            </div>
          </section>
        </section>

        <section id="view-status" class="view">
          <section class="card">
            <div class="card-head">
              <span class="card-title">Signal Mapping</span>
              <span id="mappingSummaryMini" class="meta">Loading...</span>
            </div>
            <div class="card-body">
              <div id="systemStatusMapping" class="content-empty">Loading...</div>
            </div>
          </section>

          <section class="card">
            <div class="card-head">
              <span class="card-title">Cron Jobs</span>
              <span id="cronSummaryMini" class="meta">Loading...</span>
            </div>
            <div class="card-body" id="cronBodyInline">
              <div id="cronContent" class="content-empty">Loading...</div>
            </div>
          </section>

          <section class="card">
            <div class="card-head">
              <span class="card-title">System Status</span>
              <span id="systemStatusSummaryMini" class="meta">Loading...</span>
            </div>
            <div class="card-body">
              <div class="pill-row"><span id="systemHealthPill" class="pill">live</span></div>
              <div class="status-panel">
                <h3>Resources</h3>
                <div id="systemStatusResources" class="metric-grid"></div>
              </div>
              <div class="status-grid" id="systemStatusExtra">
                <div class="status-panel">
                  <h3>Usage</h3>
                  <div id="systemStatusUsage" class="content-empty">Loading...</div>
                </div>
                <div class="status-panel">
                  <h3>Speech-to-Text</h3>
                  <div id="systemStatusStt" class="content-empty">Loading...</div>
                </div>
                <div class="status-panel">
                  <h3>Settings</h3>
                  <div id="systemStatusSettings" class="content-empty">Loading...</div>
                </div>
              </div>
            </div>
          </section>
        </section>
      </main>
    </div>
  </body>
</html>
